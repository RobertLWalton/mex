// MEXAS Compile Test 15 Input
//
// File:        mexas_compile_test_15.mex
// Author:      Bob Walton (walton@acm.org)
// Date:        Sat Oct 19 02:29:46 AM EDT 2024
//
// The authors have placed this program in the public
// domain; they make no warranty and accept no liability
// for this program.

// JMP Optimize Test
//
SET_TRACE SET_OPTIMIZE NOP
    [13:0;0] SET_TRACE T_ALWAYS 1310720 0 0

BEGF JMP-2ARG-TEST
    [15:1;0] BEGF T_BEGF 0 1 0; [< JMP-2ARG-TEST >]
    PUSHI 1
    [16:2;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 2
    [17:3;2] PUSHI T_PUSH 0 0 0 2; *
    JMPEQ BAD
    [18:4;0] JMPEQ T_JMPS 0 0 0; BAD
    JMP GOOD
    [19:5;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [20:6;0] LABEL BAD
    [18:4;0] JMPEQ T_JMPS 0 0 2; BAD
    TRACE 'JMPEQ: WRONG JMP'
    [21:6;0] TRACE T_ALWAYS 0 0 0; [< "JMPEQ: WRONG JMP" >]
    LABEL GOOD
    [22:7;0] LABEL GOOD
    [19:5;0] JMP T_JMP 0 0 2; GOOD

    PUSHI 1
    [24:7;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 1
    [25:8;2] PUSHI T_PUSH 0 0 0 1; *
    JMPEQ GOOD
    [26:9;0] JMPEQ T_JMPS 0 0 0; GOOD
    TRACE 'JMPEQ: WRONG NO-JMP'
    [27:10;0] TRACE T_ALWAYS 0 0 0; [< "JMPEQ: WRONG NO-JMP" >]
    LABEL GOOD
    [28:11;0] LABEL GOOD
    [26:9;0] JMPEQ T_JMPS 0 0 2; GOOD

    PUSHI 1
    [30:11;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 2
    [31:12;2] PUSHI T_PUSH 0 0 0 2; *
    JMPNEQ GOOD
    [32:13;0] JMPNEQ T_JMPS 0 0 0; GOOD
    TRACE 'JMPNEQ: WRONG NO-JMP'
    [33:14;0] TRACE T_ALWAYS 0 0 0; [< "JMPNEQ: WRONG NO-JMP" >]
    LABEL GOOD
    [34:15;0] LABEL GOOD
    [32:13;0] JMPNEQ T_JMPS 0 0 2; GOOD

    PUSHI 1
    [36:15;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 1
    [37:16;2] PUSHI T_PUSH 0 0 0 1; *
    JMPNEQ BAD
    [38:17;0] JMPNEQ T_JMPS 0 0 0; BAD
    JMP GOOD
    [39:18;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [40:19;0] LABEL BAD
    [38:17;0] JMPNEQ T_JMPS 0 0 2; BAD
    TRACE 'JMPNEQ: WRONG JMP'
    [41:19;0] TRACE T_ALWAYS 0 0 0; [< "JMPNEQ: WRONG JMP" >]
    LABEL GOOD
    [42:20;0] LABEL GOOD
    [39:18;0] JMP T_JMP 0 0 2; GOOD

    PUSHI -10
    [44:20;1] PUSHI T_PUSH 0 0 0 -10; *
    PUSHI 0
    [45:21;2] PUSHI T_PUSH 0 0 0 0; *
    JMPGEQ * BAD1
    [46:22;0] JMPGEQ T_JMPS 0 1 0; BAD1
    PUSHI +10
    [47:23;2] PUSHI T_PUSH 0 0 0 10; *
    JMPGEQ BAD2
    [48:24;0] JMPGEQ T_JMPS 0 0 0; BAD2
    JMP GOOD
    [49:25;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD1
    [50:26;0] LABEL BAD1
    [46:22;0] JMPGEQ T_JMPS 0 1 4; BAD1
    TRACE 'JMPGEQ *: WRONG JMP'
    [51:26;0] TRACE T_ALWAYS 0 0 0; [< "JMPGEQ *: WRONG JMP" >]
    JMP GOOD
    [52:27;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD2
    [53:28;0] LABEL BAD2
    [48:24;0] JMPGEQ T_JMPS 0 0 4; BAD2
    TRACE 'JMPGEQ: WRONG JMP'
    [54:28;0] TRACE T_ALWAYS 0 0 0; [< "JMPGEQ: WRONG JMP" >]
    LABEL GOOD
    [55:29;0] LABEL GOOD
    [52:27;0] JMP T_JMP 0 0 2; GOOD
    [49:25;0] JMP T_JMP 0 0 4; GOOD

    PUSHI -10
    [57:29;1] PUSHI T_PUSH 0 0 0 -10; *
    PUSHI -15
    [58:30;2] PUSHI T_PUSH 0 0 0 -15; *
    JMPGEQ * GOOD
    [59:31;0] JMPGEQ T_JMPS 0 1 0; GOOD
    PUSHI +10
    [60:32;2] PUSHI T_PUSH 0 0 0 10; *
    JMPGEQ BAD
    [61:33;0] JMPGEQ T_JMPS 0 0 0; BAD
    JMP GOOD
    [62:34;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [63:35;0] LABEL BAD
    [61:33;0] JMPGEQ T_JMPS 0 0 2; BAD
    TRACE 'JMPGEQ: WRONG JMP'
    [64:35;0] TRACE T_ALWAYS 0 0 0; [< "JMPGEQ: WRONG JMP" >]
    JMP GOOD
    [65:36;0] JMP T_JMP 0 0 0; GOOD

    PUSHI -10
    [67:37;1] PUSHI T_PUSH 0 0 0 -10; *
    PUSHI +15
    [68:38;2] PUSHI T_PUSH 0 0 0 15; *
    JMPGEQ * BAD
    [69:39;0] JMPGEQ T_JMPS 0 1 0; BAD
    PUSHI +10
    [70:40;2] PUSHI T_PUSH 0 0 0 10; *
    JMPGEQ GOOD
    [71:41;0] JMPGEQ T_JMPS 0 0 0; GOOD
    TRACE 'JMPGEQ: WRONG NO-JMP'
    [72:42;0] TRACE T_ALWAYS 0 0 0; [< "JMPGEQ: WRONG NO-JMP" >]
    JMP GOOD
    [73:43;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [74:44;0] LABEL BAD
    [69:39;0] JMPGEQ T_JMPS 0 1 5; BAD
    TRACE 'JMPGEQ *: WRONG JMP'
    [75:44;0] TRACE T_ALWAYS 0 0 0; [< "JMPGEQ *: WRONG JMP" >]
    JMP GOOD
    [76:45;0] JMP T_JMP 0 0 0; GOOD

    PUSHI 1
    [78:46;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 1
    [79:47;2] PUSHI T_PUSH 0 0 0 1; *
    JMPGT BAD
    [80:48;0] JMPGT T_JMPS 0 0 0; BAD
    JMP GOOD
    [81:49;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [82:50;0] LABEL BAD
    [80:48;0] JMPGT T_JMPS 0 0 2; BAD
    TRACE 'JMPGT: WRONG JMP'
    [83:50;0] TRACE T_ALWAYS 0 0 0; [< "JMPGT: WRONG JMP" >]
    LABEL GOOD
    [84:51;0] LABEL GOOD
    [81:49;0] JMP T_JMP 0 0 2; GOOD
    [76:45;0] JMP T_JMP 0 0 6; GOOD
    [73:43;0] JMP T_JMP 0 0 8; GOOD
    [71:41;0] JMPGEQ T_JMPS 0 0 10; GOOD
    [65:36;0] JMP T_JMP 0 0 15; GOOD
    [62:34;0] JMP T_JMP 0 0 17; GOOD
    [59:31;0] JMPGEQ T_JMPS 0 1 20; GOOD

    PUSHI 1
    [86:51;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI -1
    [87:52;2] PUSHI T_PUSH 0 0 0 -1; *
    JMPGT GOOD
    [88:53;0] JMPGT T_JMPS 0 0 0; GOOD
    TRACE 'JMPGT: WRONG NO-JMP'
    [89:54;0] TRACE T_ALWAYS 0 0 0; [< "JMPGT: WRONG NO-JMP" >]
    LABEL GOOD
    [90:55;0] LABEL GOOD
    [88:53;0] JMPGT T_JMPS 0 0 2; GOOD

    PUSHI 1
    [92:55;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 1
    [93:56;2] PUSHI T_PUSH 0 0 0 1; *
    JMPLT BAD
    [94:57;0] JMPLT T_JMPS 0 0 0; BAD
    JMP GOOD
    [95:58;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [96:59;0] LABEL BAD
    [94:57;0] JMPLT T_JMPS 0 0 2; BAD
    TRACE 'JMPLT: WRONG JMP'
    [97:59;0] TRACE T_ALWAYS 0 0 0; [< "JMPLT: WRONG JMP" >]
    LABEL GOOD
    [98:60;0] LABEL GOOD
    [95:58;0] JMP T_JMP 0 0 2; GOOD

    PUSHI -1
    [100:60;1] PUSHI T_PUSH 0 0 0 -1; *
    PUSHI 1
    [101:61;2] PUSHI T_PUSH 0 0 0 1; *
    JMPLT GOOD
    [102:62;0] JMPLT T_JMPS 0 0 0; GOOD
    TRACE 'JMPLT: WRONG NO-JMP'
    [103:63;0] TRACE T_ALWAYS 0 0 0; [< "JMPLT: WRONG NO-JMP" >]
    LABEL GOOD
    [104:64;0] LABEL GOOD
    [102:62;0] JMPLT T_JMPS 0 0 2; GOOD

    PUSHI 1
    [106:64;1] PUSHI T_PUSH 0 0 0 1; *
    PUSHI 0
    [107:65;2] PUSHI T_PUSH 0 0 0 0; *
    JMPLEQ BAD
    [108:66;0] JMPLEQ T_JMPS 0 0 0; BAD
    JMP GOOD
    [109:67;0] JMP T_JMP 0 0 0; GOOD
    LABEL BAD
    [110:68;0] LABEL BAD
    [108:66;0] JMPLEQ T_JMPS 0 0 2; BAD
    TRACE 'JMPLEQ: WRONG JMP'
    [111:68;0] TRACE T_ALWAYS 0 0 0; [< "JMPLEQ: WRONG JMP" >]
    LABEL GOOD
    [112:69;0] LABEL GOOD
    [109:67;0] JMP T_JMP 0 0 2; GOOD

    PUSHI 0
    [114:69;1] PUSHI T_PUSH 0 0 0 0; *
    PUSHI 0
    [115:70;2] PUSHI T_PUSH 0 0 0 0; *
    JMPLEQ GOOD
    [116:71;0] JMPLEQ T_JMPS 0 0 0; GOOD
    TRACE 'JMPLEQ: WRONG NO-JMP'
    [117:72;0] TRACE T_ALWAYS 0 0 0; [< "JMPLEQ: WRONG NO-JMP" >]
    LABEL GOOD
    [118:73;0] LABEL GOOD
    [116:71;0] JMPLEQ T_JMPS 0 0 2; GOOD


    NOP 'Only Traced if Optimize is OFF'
    [121:73;0] NOP T_NOP 0 0 0; [< "Only Traced if Optimize is OFF" >]
ENDF
    [15:1;0] BEGF T_BEGF 0 1 74; [< JMP-2ARG-TEST >]
    [122:74;0] ENDF T_ENDF 0 1 0

SET_OPTIMIZE OFF
    [124:75;0] SET_OPTIMIZE T_SET_OPTIMIZE 0 0 0
CALL JMP-2ARG-TEST 0
    [125:76;0] CALLM T_CALLM 0 0 1; [< JMP-2ARG-TEST >]
SET_OPTIMIZE ON
    [126:77;0] SET_OPTIMIZE T_SET_OPTIMIZE 1 0 0
CALL JMP-2ARG-TEST 0
    [127:78;0] CALLM T_CALLM 0 0 1; [< JMP-2ARG-TEST >]

BEGF JMP-1ARG-TEST
    [129:79;0] BEGF T_BEGF 0 1 0; [< JMP-1ARG-TEST >]
    NOP 'Only Traced if Optimize is OFF'
    [130:80;0] NOP T_NOP 0 0 0; [< "Only Traced if Optimize is OFF" >]
ENDF
    [129:79;0] BEGF T_BEGF 0 1 3; [< JMP-1ARG-TEST >]
    [131:81;0] ENDF T_ENDF 0 1 0

SET_OPTIMIZE OFF
    [133:82;0] SET_OPTIMIZE T_SET_OPTIMIZE 0 0 0
CALL JMP-1ARG-TEST 0
    [134:83;0] CALLM T_CALLM 0 0 79; [< JMP-1ARG-TEST >]
SET_OPTIMIZE ON
    [135:84;0] SET_OPTIMIZE T_SET_OPTIMIZE 1 0 0
CALL JMP-1ARG-TEST 0
    [136:85;0] CALLM T_CALLM 0 0 79; [< JMP-1ARG-TEST >]
* {13:0,0,1} SET_TRACE: NOP SET_OPTIMIZE
* {124:75,0,3} SET_OPTIMIZE: OFF <= OFF
*** {121:73,0,45} NOP: "Only Traced if Optimize is OFF"
* {126:77,0,47} SET_OPTIMIZE: ON <= OFF
* {133:82,0,92} SET_OPTIMIZE: OFF <= ON
*** {130:80,0,94} NOP: "Only Traced if Optimize is OFF"
* {135:84,0,96} SET_OPTIMIZE: ON <= OFF
mexas_compile_test_15.mex successfully compiled
